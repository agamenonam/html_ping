<html>

<head>

 <meta charset="utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="lay.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="http://knockoutjs.com/downloads/knockout-3.5.0rc.js"></script>
  
<title>teste de ping servidores intera</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>


<!-- oldies
<script>
    var ping = new Date;

    $.ajax({
        url: "google.com",
        cache:false,
        success: function(output){ 
            ping = new Date - ping;
            Console.log("Ping/Latency: " + ping);
        }
    });
</script>


<script>
    function ping(){
       $.ajax({
          url: 'ping.html',
          success: function(result){
             alert('reply');
          },     
          error: function(result){
              alert('timeout/error');
          }
       });
    }
</script>
-->


</head>



<div class="container">
  <h2>Avaliar status de servidores</h2>
  <!-- Trigger the modal with a button -->
  <button type="button" class="btn btn-info btn-xl" data-toggle="modal" data-target="#myModal" onclick="arroz()">Check Server Status</button>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          
		  <h1>Some text in the modal.</h1>
		  <p>O que é Lorem Ipsum?
             Lorem Ipsum é simplesmente uma simulação de texto da indústria tipográfica e de impressos, e vem sendo utilizado desde o século XVI, quando um impressor desconhecido pegou uma bandeja de tipos e os embaralhou para fazer um livro de modelos de tipos. Lorem Ipsum sobreviveu não só a cinco séculos, como também ao salto para a editoração eletrônica, permanecendo essencialmente inalterado. Se popularizou na década de 60, 
			<ol>
			 <li> <p align ='left'>GATEWAY&nbsp;<span style="background-color: #47bc2d; color: #ffffff; display: inline-block; padding: 1px 10px; font-weight: bold; border-radius: 10px;">ONLINE</span>.</p> </li>
			 <li> <p align ='left'>FIREWALL&nbsp;<span style="background-color: yellow; color: black; display: inline-block; padding: 1px 10px; font-weight: bold; border-radius: 10px;">NO INTERNET</span>.</p> </li>
			 <li> <p align ='left'>HOSTVM01&nbsp;<span style="background-color: red; color: #a8a8a8; display: inline-block; padding: 1px 10px; font-weight: bold; border-radius: 10px;">OFFLINE</span>.</p> </li>
			 </ol>
			 quando a Letraset lançou decalques contendo passagens de Lorem Ipsum, e mais recentemente quando passou a ser integrado a softwares de editoração eletrônica como Aldus PageMaker.</p>
			 
			 <!--teste de internet em si -->
			 <ul data-bind="foreach:servers">
    <li> <a href="#" data-bind="text:name,attr:{href: 'http://'+name}">tester</a> <span data-bind="text:status,css:status"></span>

    </li>
</ul>
						
			<script>
				
							function ping(ip, callback) {
				
					if (!this.inUse) {
						this.status = 'unchecked';
						this.inUse = true;
						this.callback = callback;
						this.ip = ip;
						var _that = this;
						this.img = new Image();
						this.img.onload = function () {
							_that.inUse = false;
							_that.callback('responded');
				
						};
						this.img.onerror = function (e) {
							if (_that.inUse) {
								_that.inUse = false;
								_that.callback('responded', e);
							}
				
						};
						this.start = new Date().getTime();
						this.img.src = "http://" + ip;
						this.timer = setTimeout(function () {
							if (_that.inUse) {
								_that.inUse = false;
								_that.callback('timeout');
							}
						}, 5000);
					}
				}
				var PingModel = function (servers) {
					var self = this;
					var myServers = [];
					ko.utils.arrayForEach(servers, function (location) {
						myServers.push({
							name: location,
							status: ko.observable('unchecked')
						});
					});
					self.servers = ko.observableArray(myServers);
					ko.utils.arrayForEach(self.servers(), function (s) {
						s.status('checking');
						new ping(s.name, function (status, e) {
							s.status(status);
						});
					});
				};
				var komodel = new PingModel(['americas.hgst.com',
					'172.34.10.25',
					'172.34.10.13',
					'google.com.br',
					'msn.com',
					'astalavista.box.sk',
					'179.191.233.233', 
					'172.34.10.38', 
					'172.16.0.16'
					]);
					function arroz (){
				ko.applyBindings(komodel);
					}				
				</script>
			<span data-bind="text:status,css:status"></span>

			</li>
			</ul>
			 
			 <button onclick="data-bind="foreach:servers">Reload page</button>
			 
			 
			 
			 <!--fim do teste de internet -->
			 
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		   <button type="button" class="btn btn-default" data-dismiss="modal" data-toggle="modal" data-target="#myModal" onclick="reload()">Teste</button>
		   
		   <script>
function reload() {
    location.reload();
	}
</script>
		   
        </div>
      </div>
      
    </div>
		
  </div>
  
</div>


</html>
